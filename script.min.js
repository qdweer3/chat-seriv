let currentUser=null;function togglePage(e){document.querySelectorAll(".page").forEach(t=>{t.style.display="none"}),document.getElementById(e).style.display="block"}function login(){const e=document.getElementById("loginUsername").value,t=document.getElementById("loginPassword").value,o=JSON.parse(localStorage.getItem("users"))||[],r=o.find(t=>t.username===e&&t.password===t);r?(currentUser=e,togglePage("chatPage"),updateBadge(),updateOnlineUsers(o)):(alert("Invalid username or password."),console.log("Invalid username or password."))}function register(){const e=document.getElementById("registerUsername").value,t=document.getElementById("registerPassword").value;if(e&&t){let o=JSON.parse(localStorage.getItem("users"))||[];o.push({username:e,password:t,createdAt:(new Date).getTime()}),localStorage.setItem("users",JSON.stringify(o)),currentUser=e,togglePage("chatPage"),updateBadge(),updateOnlineUsers(o)}else alert("Please enter username and password.")}function appendToFile(e,t){const o=require("fs");o.appendFileSync(e,t)}function sendMessage(){const e=document.getElementById("messageInput"),t=e.value.trim();if(t){const o=document.getElementById("chatMessages"),r=document.createElement("div");r.setAttribute("id","message_"+Date.now()),r.innerHTML=`<strong>${currentUser}</strong>: ${t}`,o.appendChild(r),e.value="",updateBadge()}}function isNewAccount(){const e=JSON.parse(localStorage.getItem("users"))||[],t=e.find(e=>e.username===currentUser);if(t){const o=(new Date).getTime()-t.createdAt;return o/(1e3*60*60*24)<=3}return!1}function updateBadge(){const e=document.getElementById("newAccountBadge");e&&(e.style.display=isNewAccount()?"inline-block":"none")}function logout(){currentUser=null,togglePage("loginPage")}function toggleDarkMode(){document.body.classList.toggle("dark-mode")}function updateOnlineUsers(e){const t=document.getElementById("onlineUsers");t.innerHTML="",e.forEach(e=>{const o=document.createElement("li");o.textContent=e.username,t.appendChild(o)})}
